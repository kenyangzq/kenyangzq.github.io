<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Welcome to my hub">
<meta property="og:type" content="website">
<meta property="og:title" content="Runner">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Runner">
<meta property="og:description" content="Welcome to my hub">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Runner">
<meta name="twitter:description" content="Welcome to my hub">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Runner</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Runner</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Hacking to the gate</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/23/Manually-Deploy-Cloud-Architecture/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/23/Manually-Deploy-Cloud-Architecture/" itemprop="url">Manually Deploy Cloud Architecture</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-23T13:31:01-05:00">
                2017-09-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Manually Deploy Cloud Architecture</h1>
<p>This is a step by step tutorial of how to setup LAMP stack on two virtual machines on OpenStack cloud infrastructure. After configuration, we want to deploy the &lt;a href=&quot;https://github.com/Anirban2404/phpMySQLapp.git&quot;&gt;phpMySQLapp&lt;/a&gt; on our servers. The two virtuall machines will be functioned as web server and database server respectively.</p>
<p>Creation and configuration of virtual machines on open stack can be found &lt;a href=&quot;https://www.openstack.org/software/start/&quot;&gt;here&lt;/a&gt;.  We will be using Ubuntu 16.04 as the OS of both virtuall machines. Note, we need to associate a floating IP address to our public web server.</p>
<h2>Step 1: Install LAMP stack on Web Server</h2>
<p>Use ssh to login into the Web server. We will first install the LAMP stack manually. LAMP stack includes Linux, Apache, MySQL and PHP. It's considered by many as the platform of choice for development and deployment of web applications.</p>
<p>Note: you need to have a non-root user with <em>sudo</em> privileges to continue.</p>
<p>To install Apache, use the following command:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install apache2</span><br></pre></td></tr></table></figure></p>
<p>Then for MySQL, the command is very similar:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure></p>
<p>For PHP, we need some additional metapackages:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install php libapache2-mod-php php-mcrypt php-mysql</span><br></pre></td></tr></table></figure></p>
<p>Your server should restart the apache server; if not, use the following command:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo /etc/init.d/apache2 restart</span><br></pre></td></tr></table></figure></p>
<p>You should now have the Ubuntu LAMP server works. You can check php works by running any php files in <code>/var/www/</code> directory.</p>
<h2>Step 2: Configure Apache on Web Server</h2>
<p>Before we test our apache, the first thing we need to do is to modify our firework to allow outside access to the default web ports. For a default setting, you should have a UFW firewall configured to restrict access to your server.</p>
<p>During installation, Apache registers itself with UFW to provide a few application profiles. We can use these profiles to simplify the process of enabling or disabling access to Apache through our firewall.</p>
<p>To check the ufw application profiles, use</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw app list</span><br></pre></td></tr></table></figure></p>
<p>You should get an output like the following:</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Available applications:</span><br><span class="line">  Apache</span><br><span class="line">  Apache Full</span><br><span class="line">  Apache Secure</span><br><span class="line">  OpenSSH</span><br></pre></td></tr></table></figure></p>
<p>For our purposes, we will allow incoming traffic for the <strong>Apache Full</strong> profile by typing:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw allow &apos;Apache Full&apos;</span><br></pre></td></tr></table></figure></p>
<p>You can verify the change by:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ufw status</span><br></pre></td></tr></table></figure></p>
<p>The output should look like:</p>
<p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Status: active</span><br><span class="line"></span><br><span class="line">To                         Action      From</span><br><span class="line">--                         ------      ----</span><br><span class="line">OpenSSH                    ALLOW       Anywhere                  </span><br><span class="line">Apache Full                ALLOW       Anywhere                  </span><br><span class="line">OpenSSH (v6)               ALLOW       Anywhere (v6)             </span><br><span class="line">Apache Full (v6)           ALLOW       Anywhere (v6)</span><br></pre></td></tr></table></figure></p>
<p>Now, hopefully you will have your Apache working.</p>
<h2>Step 3 Get the App repository and Configure PHP</h2>
<p>Use git clone to clone the repository into your front end server (Web Server).</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/Anirban2404/phpMySQLapp.git</span><br></pre></td></tr></table></figure></p>
<p>Move the directory to under <code>/var/www/html/</code> to enable php script. Use <code>tree</code> can clearly see the structure of the directory.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@mywebserver:/var/www/html$ tree</span><br><span class="line">.</span><br><span class="line">├── admin_area</span><br><span class="line">│   ├── insertbook.php</span><br><span class="line">│   ├── insert_books.php</span><br><span class="line">│   ├── insertmovie.php</span><br><span class="line">│   └── insert_movies.php</span><br><span class="line">├── books</span><br><span class="line">│   ├── functions</span><br><span class="line">│   │   ├── fetch.php</span><br><span class="line">│   │   ├── functions.php</span><br><span class="line">│   │   └── getbook.php</span><br><span class="line">│   ├── home.php</span><br><span class="line">│   ├── images</span><br><span class="line">│   │   └── background_image.jpg</span><br><span class="line">│   └── includes</span><br><span class="line">│       └── bookDatabase.php</span><br><span class="line">├── homePage.JPG</span><br><span class="line">├── index.php</span><br><span class="line">├── index.html</span><br><span class="line">├── movies</span><br><span class="line">│   ├── functions</span><br><span class="line">│   │   ├── fetch.php</span><br><span class="line">│   │   ├── functions.php</span><br><span class="line">│   │   └── getmovie.php</span><br><span class="line">│   ├── home.php</span><br><span class="line">│   ├── images</span><br><span class="line">│   │   └── background_image.jpg</span><br><span class="line">│   └── includes</span><br><span class="line">│       └── movieDatabase.php</span><br><span class="line">├── mySqlDB</span><br><span class="line">│   ├── bookDB.sql</span><br><span class="line">│   └── movieDB.sql</span><br><span class="line">├── README.md</span><br><span class="line">└── siteImages</span><br><span class="line">    ├── books.jpg</span><br><span class="line">    └── movies.jpg</span><br></pre></td></tr></table></figure></p>
<p>Note that <code>index.html</code> is the default page in the Apache server. You can either delete that file or configure PHP so that it will look into <code>index.php</code> to setup the front page.</p>
<p>To configure PHP, use <code>vim</code> or any texteditor like <code>nano</code>  to open <code>/etc/apache2/mods-enabled/dir.conf</code> as:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/apache2/mods-enabled/dir.conf</span><br></pre></td></tr></table></figure></p>
<p>Change the order of the directory index into:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DirectoryIndex index.php index.html index.cgi index.pl index.xhtml index.htm</span><br></pre></td></tr></table></figure></p>
<p>Now php will look for <code>index.php</code> before <code>index.html</code>.</p>
<h2>Step 4 Install MySQL and Configure it on Database Server</h2>
<p>SSH into our database server. As in the front end, we use apt-get to install MySQL.</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure></p>
<p>When installing MySQL, it will prompt for password. Please remember it and we will use it later.</p>
<p>We also need to clone the repository of the Web App here. We need to import the 	database in the repository to our MySQL. So we do git clone again:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/Anirban2404/phpMySQLapp.git</span><br></pre></td></tr></table></figure></p>
<p>Following the instruction on the repository README, we import the database into our MySQL database by</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u &lt;username&gt; -p &lt;databasename&gt; &lt; &lt;filename.sql&gt;</span><br></pre></td></tr></table></figure></p>
<p>Here, default username is root. Database names can be anything you like, but we are going to use them later. I chose 'bookstore' for my book database and 'movieDb' for my movie database. The files you need to import are in the 'mySqlDB' folder, as shown in the above tree. Argument -u is for username, -p means using password. This command will prompt you to enter your password for the database.</p>
<p>Now that we have import our database, we need to configure MySQL. First, use whatever texteditor you prefer to open the configuration file of MySQL. The file location may vary depend on different package. For this demonstration, the command is:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf</span><br></pre></td></tr></table></figure></p>
<p>In the configuration file, we need to bind our IP address to our database. Scroll down to find a line that looks like:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bind-address		= xxx.xxx.xx.xx</span><br></pre></td></tr></table></figure></p>
<p>Replace the IP address with our database server's IP address. If there is a line starts with skip-networking, comment it out:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#skip-networking</span><br></pre></td></tr></table></figure></p>
<p>Now save and exit the file. Restart the MySQL service:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ service mysql restart</span><br></pre></td></tr></table></figure></p>
<p>The final step is to grant the privilege of our user from other IP address. First Enter MySQL database by</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mysql -u root -p</span><br></pre></td></tr></table></figure></p>
<p>Replace root with your username if needed. In MySQL, type the following command:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &apos;USERNAME&apos;@&apos;%&apos; IDENTIFIED BY &apos;PASSWORD&apos; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure></p>
<p>Here 'USERNAME' should be your username, 'PASSWORD' should be your password. This command will grant privilege to user from any IP address. You can check that privileges are granted by:</p>
<p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * from information_schema.user_privileges;</span><br></pre></td></tr></table></figure></p>
<p>You should see your user at the bottom of the chart. Now your database server is ready for use.</p>
<h2>Step 5 Final Configuration on Web App</h2>
<p>A final modification is on our Web server. SSH into it as usual. Use text editor to open <code>/var/www/html/books/includes/bookDatabase.php</code> and <code>/var/www/html/movies/includes/movieDatabase.php</code>. You need to replace the IP address there with the database server's IP address. If your password is not default password, replace it as well.</p>
<p>After this final step, <strong>Congratulations!</strong> You should have manually deploy a cloud architecture!</p>
<p>To run this app, open a browser and enter your web server's public floating IP address. You should see a page like:</p>
<p>&lt;img src=&quot;images/Others/homePage.JPG&quot;&gt;</p>
<h2>Reference</h2>
<ol>
<li>http://howtoubuntu.org/how-to-install-lamp-on-ubuntu</li>
<li>https://stackoverflow.com/questions/8348506/grant-remote-access-of-mysql-database-from-any-ip-address</li>
<li>https://www.digitalocean.com/community/tutorials/how-to-install-the-apache-web-server-on-ubuntu-16-04</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/10/Research-Note-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/10/Research-Note-10/" itemprop="url">Research-Note-10</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-10T22:25:22-05:00">
                2017-09-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 10</h1>
<p>Last week I was seriously illed so I did skip the note. Since my school starts, I can only use my leisure time on this research project, so without doubt, my progress is much slower compared to in summer. However, in last week, I have made some breakthrough and I thought it's worth noting.</p>
<h3>C1 Smoothness Condition</h3>
<p>Right now our main goal is to solve scatter fitting problem using tetrahedron partition in 3D space. Professor Schumaker has a outline to attempt this problem. We first need to partition the space using tetrahedron, then we need to figure out how to enforce C1 smoothness condition between each unit tetrahedron. After that, we can use the idea of minimum energy by adding a penalizing terms of the smoothness condition. If we can reach this far, we can then choose the right parameter and solve the problem.</p>
<p>Now the only missing key is to get the C1 smoothness condition. By C1 smoothness, it means that splines between different tetrahedron not only join on the sharing faces, but the directional partial derivative also agrees on the border. Since we are representing splines with coefficent at domain points, it can be proved that if the coefficient on the sharing faces agree, we will have C0 smoothness condition. And from that on, with one more layer, or I should say internal faces, of coefficient agree, we will one degree higher smoothness condition.</p>
<p>Enforcing coefficient to agree on the sharing face is easy. Because of the way we store the spline, it automatically satisfy the C0 smoothness condition. C1, on the other hand, is far more tricky. It involves lots of geometric manipulation of the coefficient tetrahedrons.</p>
<p>Long story short, Professor Larry came up with several functions to get the C1 smoothness condition with d = 3. The idea is to loop over all the interior face. For each face, get the left and right tetrahedrons' coefficient. Perform some geometric manipulation on them and obtain the internal layer of coefficient by rotations. Then enforce them to agree by setting up a linear system of equation.</p>
<p>After he show us the code, I spent a few days studying it. And in today's afternoon I combined his functions with my getindextetra and other helpers. With some struggles, I believe I have extended the functions to give C1 smoothness condition for any value of d. So far these functions pass all the test cases I have. This means we have obtained the final missing piece to solve scatter data fitting problems.</p>
<p>Probably in next week, we will put all the pieces together and finally obtain applicable solver.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/26/Research-New-Start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/26/Research-New-Start/" itemprop="url">Research-New-Start</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-26T17:19:10-05:00">
                2017-08-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>New Beginning</h1>
<p>By the end of summer, my research project officially ended. In last week, cooperating with Shiying Li, PhD student in Math, we came up with a Tetrahedron adaptive program. I will summarize our work in last week in this note.</p>
<h2>T3adaptive</h2>
<p>In previous week, I have already finish this new refinement function named <em>refinetetra3</em> which will choose the largest boundary face and split it in 3 to get three new sub-tetrahedrons. Later in fall, I plan to finalize it so that it can split internal faces.</p>
<p>The remaining puzzles are interpolation functions, grid error evaluations and an error function to choose the tetrahedron to further refine. Luckily, these functions are just extensions from the 2D cases. And I have gathered enough experiences on them in 2D box project and 3D cube project. Therefore, it only took me 1 whole day to finish them.</p>
<p>After we have gathered all the tools, it's finally the time to put everything up together.</p>
<p>In the first part of our big program,  we need to initialize the big partition. Other than reading from files like we did before, I also wrote a small initialization function to create Delaunay partition on 3D box of any size.</p>
<p>Then we use our good old friend, list function <em>tetralist</em> to get all the partition information we need.</p>
<p>Suppose we are given a target function, now that we have all the parts ready, we performed a first interpolation on the unrefine setting, which gives us a long coefficient vector $c$. Then we can start our main refinement process.</p>
<p>In each iteration, we did the following</p>
<ol>
<li>Based on the current coefficient, we calculate the error scaled by the volume in each tetrahedron using the error function. By error we mean the max error inside the tetrahedron.</li>
<li>Then we sort the error and find the largest 20% and store their indices in a list.</li>
<li>For every tetrahedron in the list, if it's on the boundary, we use <em>refine3</em> to refine one of its boundary faces; if it's a interior tetrahedron, we perform a Alfeld refinement using <em>refine4</em>.</li>
</ol>
<p>We predefined the number of iteration. If in an iteration we have the max error of all tetrahedron less than a very small number, say $10^{-5}$, we exit the loop.</p>
<p>After the loop, we use grid error evaluation to estimate the error and plot the final refinement.</p>
<p>In this refinement program, we can get exact result for any trivariate polynomial given that the degree of basis Bernstein polynomial is big enough, which is what the approximation theory shows.</p>
<p>Since we still haven't found a nice way to displace 3D functions, I don't have a nice plot to show here.</p>
<h2>New Start</h2>
<p>As I mentioned, my research has officially over, but there are still lots of works that need to be done. So far no tetrahedron spline library exists and more functions are needed.</p>
<p>I have decided to continue working with Professor Schumaker on tetrahedron spline library in the fall semester. And I also plan to write a honor thesis on this topic to satisfy the requirement of graduating with honor in Math.</p>
<p>Since I have not enrolled in independent study or formally work as a RA, I can only use my spare time on this project. I will write a research note once every month instead of every week.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/24/Neural-Network-Note-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/24/Neural-Network-Note-1/" itemprop="url">Neural Network Note 1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-24T21:34:21-05:00">
                2017-08-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Basic Neural Network</h1>
<p>​	In last few months, I have taken 3 online courses on coursera and udemy about machine learning. Now I am going on a serious of deep learning course by &lt;a href = &quot;https://lazyprogrammer.me/&quot;&gt;lazy programmer &lt;/a&gt;. I do love this series a lot and I want to post some of my note on my blog.</p>
<h2>Forward Propagation</h2>
<p>It's quite a work to type the derivation and theory part in latex so I choose to just scratch the surface of them.</p>
<p>The first important function in the course is the <em>prediction</em> of a neural network using forward propagation. We create a 3 groups classification problem and predict the label use randomly initialized weight and bias.</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line">Nclass = <span class="number">500</span> </span><br><span class="line"></span><br><span class="line">X1 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">0</span>,<span class="number">-2</span>])</span><br><span class="line">X2 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">X3 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">-2</span>,<span class="number">2</span>])</span><br><span class="line">X = np.vstack([X1, X2, X3])</span><br><span class="line"></span><br><span class="line">Y = np.array([<span class="number">0</span>]*Nclass + [<span class="number">1</span>]*Nclass + [<span class="number">2</span>]*Nclass)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=Y, s = <span class="number">100</span>, alpha = <span class="number">.5</span>)</span><br><span class="line"><span class="comment"># plt.show()	</span></span><br><span class="line"></span><br><span class="line">D = <span class="number">2</span></span><br><span class="line">M = <span class="number">3</span></span><br><span class="line">K = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">W1 = np.random.randn(D,M)</span><br><span class="line">b1 = np.random.randn(M)</span><br><span class="line">W2 = np.random.randn(M,K)</span><br><span class="line">b2 = np.random.randn(K)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(X,W1,b1,W2,b2)</span>:</span></span><br><span class="line">	Z = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-X.dot(W1) - b1))</span><br><span class="line">	A = Z.dot(W2) + b2</span><br><span class="line">	expA = np.exp(A)</span><br><span class="line">	Y = expA / expA.sum(axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>)</span><br><span class="line">	<span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classification_rate</span><span class="params">(Y, P)</span>:</span></span><br><span class="line">	n_correct = <span class="number">0</span></span><br><span class="line">	n_total = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(Y)):</span><br><span class="line">		n_total +=<span class="number">1</span> </span><br><span class="line">		<span class="keyword">if</span> Y[i] == P[i]:</span><br><span class="line">			n_correct += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> float(n_correct) / n_total</span><br><span class="line"></span><br><span class="line">P_Y_given_X = forward(X,W1,b1,W2,b2)</span><br><span class="line">P = np.argmax(P_Y_given_X, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(len(P) == len(Y))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Classification rate for randomly chosen weights:"</span>, classification_rate(Y,P))</span><br></pre></td></tr></table></figure></p>
<p>The code is pretty straightforward.</p>
<h2>Back propagation</h2>
<p>The back propagation however, need some math derivation for the formula.</p>
<p>I really like the video &quot;<em>The WRONG way to learn Backpropagation</em>&quot; in this course. People do not understand bp by just taking the difference between target and prediction and claim that multiplying this $\Delta$ with weight is somehow the derivative of the cost function. We find this by strict math derivation and observe the pattern then build this algorithm. The key is to expose the pattern yourself using gradient decent and substitute the repeating pattern.</p>
<h4>Some Hardcore Math</h4>
<p>Suppose we are working on a multiclass classification problem with $K$ target classes.</p>
<p>Let's say we have a cost function $L = \sum_n\sum_k t_k^n \log(y_k^n)$ where $n$ denotes the sampel number and $k$ is for all the class. This is the famous cross entropy function and I have also discussed it in my previous note <em>Beauty in Math</em>.</p>
<p>Suppose we have $D$ input features and 1 hidden layer with $M$ nodes. We use $W_{DM}$ and $V_{MK}$ to denote the weight between input layer and hidden layer and weights between hidden layer and output layer respectively. For simplicity, suppose there is no bias terms. And further assume that we are using sigmoid function as activation function on hidden layer and softmax function on output layer.</p>
<p>Now our goal is to derive $\frac{\partial L}{\partial V_{MK}}$ and $\frac{\partial L}{\partial W_{DM}}$. First apply chain rule
$$
\frac{\partial L}{\partial V_{mk}} = \sum_n \sum_{k'} t_{k'}^n \frac{1}{y_{k'}^n}\frac{\partial y_{k'}^n}{\partial V_{mk}}
$$
Note here $k'$ is not the same as $k$ and $V_{mk}$ denotes one entry in weight matrix $V$.</p>
<p>We know that
$$
y_{k'}^n = softmax(V_{K}^TZ) = \frac{\exp^{a_k}}{\sum_j \exp^{a_j}} \
a_k = V_K^T Z = \sum_m V_{mk} Z_m
$$
where $Z$ denote the output at the hidden layer.</p>
<p>If $k = k'$ , we have $\frac{\partial y_{k'}}{\partial a_k} = y_{k'}(1-y_k)$, and else $\frac{\partial y_{k'}}{\partial a_k} = -y_{k'}y_k$. So we can rewrite them using Kronecker Delta as
$$
\frac{\partial y_{k'}}{\partial a_k} = y_{k'}(\delta_{k'k} - y_k)
$$
Then
$$
\frac{\partial y_{k'}^n}{\partial V_{mk}} = \frac{\partial y_{k'}^n}{\partial a_{k}} \frac{\partial a_k}{\partial V_{mk}} =y_{k'}(\delta_{k'k} - y_k) Z_m
$$
So
$$
\begin{align}
\frac{\partial L}{\partial V_{mk}} &amp;= \sum_n \sum_{k'} t_{k'}^n \frac{1}{y_{k'}^n}y_{k'}^n(\delta_{k'k} - y_k^n) Z_m^n \
&amp;= \sum_n \sum_{k'} (t_{k'}^n \delta_{k'k} - t_{k'}^ny_k^n)Z_m^n \
&amp;= \sum_n (t_k^n - \sum_{k'} t_{k'}^ny_k^n )Z_m^n \
&amp;= \sum_n (t_k^n - y_k^n )Z_m^n
\end{align}
$$
since $\sum_k t_k \equiv 1$ as each sample belongs to only one class.</p>
<p>The derivation for $\frac{\partial L}{\partial W_{DM}}$ is just some additional work. Since we have
$$
Z_M = \frac{1}{1 + \exp^{-W_{MK}^TX}}
$$
we can easily derive that
$$
\begin{align}
\frac{\partial L}{\partial W_{dm}} &amp; = \sum_n (t_k^n - y_k^n ) \frac{\partial Z_m^n}{\partial W_{dm}} \
&amp; = \sum_n (t_k^n - y_k^n )Z_m^n (1-Z_m^n)X_d^n
\end{align}
$$
The pattern here is actually already visiable. If we have one more hidden layer with same activation function, all we need to do is just to replace $X_d^n$ with the hidden value and multiply by addition factors. Because of the recursive nature of derivatives, back propagation is able to handle any deep neural network.</p>
<p>When putting these into code, we definitely want to vectorize them. It's pretty easy to make mistake as there are so many matrices to keep track of. One easy way I use to double check is to check the size of the matrix. Make sure their inner sizes match and the output size is the same as the target weight.</p>
<h4>Code</h4>
<p>In this code example, we keep working on the previous three groups problem.</p>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(X,W1,b1,W2,b2)</span>:</span></span><br><span class="line">	Z = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-X.dot(W1)-b1))</span><br><span class="line">	A = Z.dot(W2) + b2</span><br><span class="line">	expa = np.exp(A)</span><br><span class="line">	Y = expa / expa.sum(axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>)</span><br><span class="line">	<span class="keyword">return</span> Y, Z</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classification_rate</span><span class="params">(Y,P)</span>:</span></span><br><span class="line">	n_correct = <span class="number">0</span></span><br><span class="line">	n_total = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(Y)):</span><br><span class="line">		n_total += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> Y[i] == P[i]:</span><br><span class="line">			n_correct += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> float(n_correct) / n_total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cost</span><span class="params">(T, Y)</span>:</span></span><br><span class="line">	tot = T * np.log(Y)</span><br><span class="line">	<span class="keyword">return</span> tot.sum()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_w2</span><span class="params">(Z, T, Y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> Z.T.dot(T - Y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_b2</span><span class="params">(T,Y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> (T-Y).sum(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_w1</span><span class="params">(X, Z, T, Y, W2)</span>:</span></span><br><span class="line">	dZ = (T - Y).dot(W2.T) * Z * (<span class="number">1</span> - Z)</span><br><span class="line">	<span class="keyword">return</span> X.T.dot(dZ)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_b1</span><span class="params">(T, Y, W2, Z)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> ((T-Y).dot(W2.T) * Z * (<span class="number">1</span>-Z)).sum(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	Nclass = <span class="number">500</span></span><br><span class="line">	D = <span class="number">2</span> <span class="comment"># input</span></span><br><span class="line">	M = <span class="number">3</span> <span class="comment"># hidden layer</span></span><br><span class="line">	K = <span class="number">3</span> <span class="comment"># output</span></span><br><span class="line"></span><br><span class="line">	X1 = np.random.randn(Nclass,D) + np.array([<span class="number">0</span>,<span class="number">-2</span>])</span><br><span class="line">	X2 = np.random.randn(Nclass,D) + np.array([<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">	X3 = np.random.randn(Nclass,D) + np.array([<span class="number">-2</span>,<span class="number">2</span>])</span><br><span class="line">	X = np.vstack([X1, X2, X3])</span><br><span class="line"></span><br><span class="line">	Y = np.array([<span class="number">0</span>]*Nclass + [<span class="number">1</span>]*Nclass + [<span class="number">2</span>] * Nclass)</span><br><span class="line">	N = len(Y)</span><br><span class="line"></span><br><span class="line">	T = np.zeros((N,K))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">		T[i,Y[i]] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># plt.scatter(X[:,0], X[:,1], c=Y, s=100, alpha=.5)</span></span><br><span class="line">	<span class="comment"># plt.show()</span></span><br><span class="line"></span><br><span class="line">	W1 = np.random.randn(D, M)</span><br><span class="line">	b1 = np.random.randn(M)</span><br><span class="line">	W2 = np.random.randn(M, K)</span><br><span class="line">	b2 = np.random.randn(K)</span><br><span class="line"></span><br><span class="line">	learning_rate = <span class="number">10e-7</span></span><br><span class="line">	costs = []</span><br><span class="line">	<span class="keyword">for</span> epoch <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">		output, hidden = forward(X,W1,b1,W2,b1)</span><br><span class="line">		<span class="keyword">if</span> epoch % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">			c = cost(T, output)</span><br><span class="line">			P = np.argmax(output, axis = <span class="number">1</span>)</span><br><span class="line">			r = classification_rate(Y,P)</span><br><span class="line">			print(<span class="string">"epoch"</span>, epoch, <span class="string">"cost"</span>, c, <span class="string">"classification rate:"</span>,r)</span><br><span class="line">			costs.append(c)</span><br><span class="line"></span><br><span class="line">		W2 += learning_rate *  derivative_w2(hidden, T, output)</span><br><span class="line">		b2 += learning_rate *  derivative_b2(T, output)</span><br><span class="line">		W1 += learning_rate *  derivative_w1(X, hidden, T, output, W2)</span><br><span class="line">		b1 += learning_rate *  derivative_b1(T, output, W2, hidden)</span><br><span class="line"></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/13/Research-Note-9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/13/Research-Note-9/" itemprop="url">Research-Note-9</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-13T12:00:14-05:00">
                2017-08-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 9</h1>
<p>This week we mainly work on the tetrahedron project. Besides those little helper functions, I implemented two new main components of our project.</p>
<p>First is another new refine function. We have decided to renamed the previous refine function of tetrahedrons. The new one split a tetrahedron into 3 new tetrahedrons by finding the largest facet and its center point, and connect the opposite vertex to that center point to insert 3 new internal faces. In that way an old tetrahedron is splited into 3.</p>
<p>The implementation is quite similar to the previous function and only took me one day to finish this function.</p>
<p>&lt;img src=&quot;/images/Research/Tetra/refine3.jpg&quot; width = &quot;500&quot;&gt;</p>
<p>Here is a demonstration of the refinement.</p>
<h2>Stochastic Walk</h2>
<p>Another function is called stochastic walk. In the final stage of our project, we will have many points in our large tetrahedron partition, and we need to locate each point, aka, find the tetrahedron contain a given point.</p>
<p>Matlab has a built in function called pointLocation, which should accomplish that. However, I tested it with some simple cases and find that it fail in some. I have posted a question on the MathWork forem but receive no response so far.</p>
<p>So we decide to implement our own pointLocation function. The very first and foremost idea is to use the barycentric coordinate's property. If a point is located inside a tetrahedron then the barycentric coordinate of that point relative to that tetrahedron will have all positive components. However, this means we need to calculate the barycentric coordinate of a point for all the tetrahedron. This is too inefficient.</p>
<p>Another way is to build a K-D tree and search on the branch. However, K-D tree fails in some cases, e.g. triangulation with holes in it.</p>
<p>I did some research on Google and found a paper introducing some nice way to find point location. The paper is called <em>Walk in a Triangulation</em> by Olivier, etc. It can be found &lt;a href=&quot;https://hal.inria.fr/inria-00072509/document&quot;&gt;here&lt;/a&gt;.</p>
<p>In the paper, there are 4 different ways to find point location. The idea is quite similar. Start from a tetrahedron, according to some condition, move to next tetrahedron and so on, and finally stop in the target tetrahedron.</p>
<p>I choose to implement the Stochastic Walk as it's easier to implement and we have the available helper functions. It starts from a random tetrahedron. Choose a random facet of it, and check whether the point is on the other side of the facet. If so, move to the next tetrahedron sharing that facet; if not, move to another facet of the current tetrahedron. In the mean time, it also 'remember' the last tetrahedron visited so that we won't ends up in an infinite loop in a pair of tetrahedron.</p>
<p>There are also some other little details, but I don't want to discuss it here.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/05/Research-Note-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/05/Research-Note-8/" itemprop="url">Research-Note-8</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-05T16:34:22-05:00">
                2017-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 8</h1>
<p>This week, I continued to work on the tetrahedron project and implement several functions.</p>
<h2>Refine1</h2>
<p>The refine1 function that I started last week is pretty tricky. There are many edge cases but fortunately I have finished it.</p>
<p>As mentioned in last note, the way this function works is to find the longest edge of the target tetrahedron and use an internal face to split that edge and also the whole tetrahedron into two smaller ones. These two smaller tetrahedron will always have same volume and share a face.</p>
<p>The hard part about this function is to keep track of all other list information. For example, after we insert an interior face, we create some two subedges of the longer edge which we split, and we also add two edges on the other two faces. If a neighbor tetrahedron has been refined before, then some of these new edges may already exist, so we have to first check their existence and then update or insert new information. Same process has to be applied to all the list information we keep.</p>
<p>Another tricky part is the orientation of all the list. For instance, we keep track of a #tetra by 6 matrix for all the edges of each tetrahedron. In order to obtain the right coefficient of spline when we later implement other functions, we need to keep an order among edges of a tetrahedron. So when new edges come, we have to maintain the order.</p>
<p>I don't want to explain all the details here. The final result is promising.</p>
<h2>Refine3</h2>
<p>On Wednesday, I met with the Professor. After our discussion, we thought a more common way to refine a tetrahedron is to split it into four smaller tetrahedron by connecting each vertex to the center of the original tetrahedron. So I start to work on a new function to accomplish that.</p>
<p>To be honest, this one is easier than refine1. Since all the new vertex, new edges, and new faces are inside the refined tetrahedron, I no longer need to check their existence and separate the cases. Though orientation is still a problem, with experience in refine1, I successfully implemented this function in this week.</p>
<p>The way we initialize a partition is always reading from files. It's a simple fact that a cube can be partitioned into 5 tetrahedron, 4 of which are identical and one in the middle, as the following diagram shows.</p>
<p>&lt;img src=&quot;/images/Research/Tetra/tetra0.jpg&quot; width=&quot;500&quot;&gt;</p>
<p>After we refine the first tetrahedron using refine3 the output will be like:</p>
<p>&lt;img src=&quot;/images/Research/Tetra/tetra1.jpg&quot; width=&quot;500&quot;&gt;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/30/Research-Note-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/30/Research-Note-7/" itemprop="url">Research-Note-7</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-30T20:01:42-05:00">
                2017-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh3D/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh3D</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 7</h1>
<p>This week I first put the 3d function pieces together to make a adaptive refinement code penalizing with C0 smoothness condition. The whole program is based on the 2d version that Professor Schumaker wrote.</p>
<h2>Tadpat03d</h2>
<p>The program is called Tadapt03d, where T for tensor product, adapt0 means adaptive fitting with C0 smoothness and 3d indicates that it's on 3d cubes.</p>
<p>Same as usual, the program begins with calling the list function reclist2 to get list of information of the partition. And a function handler is created, which is our target function to approximate.</p>
<p>It then called the <em>interpdp03d</em> function to interpolate the given function f with C0 smoothness condition enforced. The <em>tsp0smooth3d</em> function, which return the smoothness condition matrix M, is called inside the <em>interpdp03d</em> function. Now that we obtain the coefficient vector $c$, we start to refine.</p>
<p>The criterial is to calculate the error of approximation in each unit cube, and find the biggest 20% of all the cube to further refine. I wrote an error calculating function called <em>rerr13d</em>, which gives the errors in each cube. We then refine those cubes with large error. I would prefer to call them a single <em>batch</em>. After we refine all the cube in the batch, we call the <em>interpdp03d</em> function again to obtain the new coefficient vector $c$. Then we start another iteration.</p>
<p>The number of <em>batches</em> or level of refinement is given by user input.</p>
<p>We still haven't found a good way to visualize 3d functions so now I can only use error to check my program.</p>
<p>One thing to notice, at this point the <em>tsp0smooth3d</em> function is actually half-complete. As mention in last note, there are at least four cases in 3d C0 smoothness condition. I still haven't figure out the right way to put in hanging edges and hanging vertices on multiple edges. So the function actually miss some of the condition.</p>
<h2>Tetra-mesh</h2>
<h3>Plot and readfile</h3>
<p>On the other hand, I have started the tetrahedron project. This one will be the final project of this summer, and I believe it will be more challenging than the previous two.</p>
<p>As I did in the previous two projects, I started by looking for a way to visualize  tetrahedrons. The function <em>patch</em> is still a reasonable choice. As I learn from visualizing cubes, I did basically the same — wrote a function to plot all the tetrahedrons given a matrix of points and a matrix of vertices of each tetra.</p>
<p>For tetrahedron, it's more like the 2d triangle case. It's hard to just initialize a bunch of tetras with few arguments. So I prefer to read in the files like Professor Schumaker did in his splinepak. I wrote a <em>readtetra</em> function to read in formatted tetrahedron data and get the basic information about the tetrahedron group.</p>
<h3>List function</h3>
<p>Now that I've got a working plot function and a read file function, I move on to the first cornerstone — list function.</p>
<p>Similar to both the cubelist and trilist case, I need to get all the needed information based on the very basic list I read from files. Specifically, I need a matrix E for tetra edge relation, a matrix F for tetra face relation, a matrix evertex for edge vertex relation, a matrix fvertex for face vertex relation and so on.</p>
<p>One tricky thing that's unique for tetrahedrons is their orientations. For rectangles and cubes, it's pretty easy to figure out how to put the edges and vertices in order. But for tetrahedron, so far I haven't get a nice and easy way to do the same.</p>
<p>I've tried to orient the edges in such a way that three edges of one face go first in an order that obey the right hand rule, and then the other three edges go next with same order. But later in my refine function, things become more complicated and I decide to leave such idea behind now.</p>
<p>It took me about two days or so to get a nice working list function.</p>
<h3>Refine1</h3>
<p>A tetrahedron can be refined in several ways, one into two, three or four. I started with the easiest, find the longest edge and use a interior face to split the edge and the whole tetra into two small ones.</p>
<p>I am still working on this function. There are some tricky place that needs to be handled. I believe by next week, I will have a nice working refine1 funcion ready.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/23/Research-Note-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/23/Research-Note-6/" itemprop="url">Research-Note-6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-23T16:06:47-05:00">
                2017-07-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh3D/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh3D</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 6</h1>
<p>This week we debug the 2d code and keep working on 3d functions.</p>
<p>In 2d case, Professor Schumaker came up with a function to add C1 smoothness condition between rectangles. This function makes use of recl and rec, vectors denoting the rectangles on the left and right of each edge. Unfortunately, due to the way we develop refinerec, there is quite a few bugs in the function. So I spent rought two days on debugging the refinerec function and finally get a version that pass enormous test cases.</p>
<h2>Interdp3d and Valtspgrid3d</h2>
<p>On the 3d side, I develop some functions as the extensions of their 2d correspondences. Two of them are interdp3d and valtspgrid3d.</p>
<p>Interdp3d interpolate a given function on the whole rectangulation and return the coefficient as a 3d Matrix. Since Matlab does not support nested list structure, we look to <em>tensor toolbox</em> for help. A tensor is just a n dimension matrix. The toolbox include basic functionality such as addition, subtraction, scalar multiplication and scalar division. It also supports multiplication between tensor and matrix on a given direction. That's what we mainly use.</p>
<p>Back to my functions. Interdp3d returns a 3d tensor storing the coefficient of the 3d spline on the rectangulation. Then I use valtspgrid0 to obtain approximation of values of the given function at 3d grid points using the coefficient we get. To varify the result, I compute the norm of error terms.</p>
<p>We haven't found a good way to visualize the function. So far we have try to plot the isosurface. There is a nice package on MathWork forem named sliceomatic. It gives a live isosurface plot, but it still does not meet our expectation.</p>
<h2>Other functions</h2>
<p>Since my refinecube function only returns lists of relation among cubes, faces, edges and vertices, I need to find a way to get the other indispensible information such as the hanging vertices, subedges, etc.</p>
<p>So I wrote a bunch of small helper functions, like gethv for get hanging vertex, getse for get subedges, getsf for get subfaces and gethe for get hanging edges. Some of the cases are pretty tricky, for example in 3d a vertex can be hanging on multiplt edges.</p>
<p>Now that I prefer not to update these other important list in the refinement function, that function will definitely be less error-prone. However, in the view of efficiency, separating them out will without doubt be slower. So far it has not been a problem.</p>
<h2>tsp0smooth3d</h2>
<p>Now I am currently working on the tsp0smooth3d function. It enforces the C0 smoothness condition on the 3d partition. Compared to the 2d tsp0smooth I implemented half month ago, this one is much more complicated. In 2d, only two cases are in consideration, hanging vertices and subedges. On the other side, in 3d, there are at least 4 cases, hanging vertices, hanging edges, subedges and subfaces. And each cases is much harder to implement, since we have higher degree of Bernstein basis polynomial.</p>
<p>It's not that easy to describe the problem I ran into while implementing this code. The vital issue is that I cannot just easily visualize the work. Most of the cases need pure imagination. When 3d is involved, things always get more complicated.</p>
<p>I hope I can finish it in few days next week.</p>
<h2>P.S.</h2>
<p>One interesting and weird thing I noticed about Matlab is its meshgrid function. In 3d cases, one needs to do</p>
<p>​				<code>[X,Y,Z] = meshgrid(ty,tx,tz)</code></p>
<p>to get the correct mesh in 3d, where ty, tx, tz are generated using linspace on their corresponding direction. Notice the weird order of argument. I am still wondering why these people prefers to pass the argument in this way. Just because of this ordering, I spent 2 more hours debugging my code.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/15/Research-Note-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/15/Research-Note-5/" itemprop="url">Research-Note-5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-15T12:38:58-05:00">
                2017-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 5</h1>
<p>I was seriously ill last week so I haven't worked a lot and updated my Research Note.</p>
<p>This two week I keep working on the T-mesh 3D functions. By today, I have finished the cubelist and refinecube function. These two function corresponds to those in 2D case, a.k.a. reclist and refinerec. In particular, refinecube is much more complicated than refinerec so I took a completely different approach on writing it. I wrote three helper functions to update information about vertices, edges and faces respectively.</p>
<p>Other than the 3d functions, now that we have finish most part of 2d cases, we can finally create some sophisticated program on top of these Bernstein basis polynomial on rectangulation.</p>
<p>For example, in this week, Professor Schumaker had come up with an adaptive fitting program using the functions we have written last month.</p>
<p>The program fit a function on a rectangulation, calculate the error in each iteration and refine those rectangles that will decrease the error in greatest extent.</p>
<p>An output case:</p>
<p>​	For fitting function
$$
f(x,y) = \tanh(40y-80x^2)-\tanh(40x-80y^2)
$$
with a initial 5 by 5 rectangulation using Bernstein basis polynomial of degree 5 on both direction and with a 50 level adaptive fitting, we get the final rectangulation as</p>
<p>&lt;img src=&quot;/images/Research/Tmesh/adapt1.jpg&quot; width=&quot;500&quot;&gt;</p>
<p>The function plot and the error plot are</p>
<p>&lt;img src=&quot;/images/Research/Tmesh/adapt2.jpg&quot; width=&quot;500&quot;&gt;</p>
<p>&lt;img src=&quot;/images/Research/Tmesh/adapt3.jpg&quot; width=&quot;500&quot;&gt;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/02/Research-Note-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/02/Research-Note-4/" itemprop="url">Research-Note-4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-02T15:10:06-05:00">
                2017-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1>Research Note 4</h1>
<p>This week my Professor Schumaker left for a conference, and won't be back until next Friday. Before leaving, he has assigned me several tasks.</p>
<h2>Tmesh Functions</h2>
<p>The very imminent one is to continue work on the Tmesh functions. We need a function to perform penalize least square approximation on refined rectangulations. It consists of two major steps:</p>
<ol>
<li>Getting the smoothness condition between unit rectangles.</li>
<li>Perform penalize least square approximation.</li>
</ol>
<h3>Smoothness Condition Matrix</h3>
<p>Since we have refining our rectangles, we may have very weird partition of the original domain region. In order to obtain a smooth surface after we approximate a function, we need to calculate the smoothness condition on sharing edges and sharing vertices.</p>
<p>The idea is not very complicate. First, we obtain the number of smoothness condition $ns$ we need by counting sharing edges and sharing vertices. The formula also involves the dimensions on x, y directions.</p>
<p>Then we construct a $ns$ by $nc$ zero matrix, where $nc$ here is the number of coefficient for a spline on the rectangulation. We can use the <em>sparse</em> function in Matlab to save storage space, since the smoothness condition only involves the coefficients on the same edge.</p>
<p>To get the value at specific entry, we need to traverse all the shared edges and hanging vertices. Note the order we put the smoothness condition in each row does not matter, because when we enforce the condition, we will simply do it by minimize the product of $cM$ where $c$ is the spline coefficient and $M$ is our matrix.</p>
<p>As we have different degree of polynomial on different direction, I chose to first traverse all the horizontal edge and then vertical. In each iteration, I get all the coefficients of domain points on the current edge, and then solve for a linear system. This system represent the fact that the Bernstein polynomial on different side of the edge reach the same value on the domain points. In other words, this is also a interpolation problem, where I represent the coefficient of the Bernstein polynomial using the coefficient on the other side. We basically do the same on all the hanging vertices.</p>
<p>Finally, the function return the well-constructed matrix $M$ as output.</p>
<h3>Penalize Least Square Approximation</h3>
<p>This function is a little similar to the one that interpolate any given function, except for the fact that we are solving least square fitting problem accompany with smoothness condition.</p>
<p>I have finished the outline of the function and there is a problem that I have to wait till Professor get back. Basically I have to use the Kronecker product of Bernstein polynomial to get the linear system. I will add details about this function in next Research Note.</p>
<h3>Refinerec</h3>
<p>In addition to the two functions above, I also spent two whole days on debugging and fixing <em>refinerec</em> function.</p>
<p>Professor notice a significant bug on the previous version. It's pretty complicated to articulate the bug. I added 250 lines and finally fixed it. Now the whole refine function is 750 line, but I believe I could have combine some of the cases or extract out some helper functions to make the whole code more readable.</p>
<h2>Other Directions</h2>
<p>Other than the Tmesh functions that I need to work on, Professor pointed two direction for me in the next two weeks. First is the 3D version of the Tmesh problems. In other words, I need to extend our current work on 2D to 3D. We both know that I will be a huge amount of work, so he only expects me to first get all the geometric functions.</p>
<p>The other direction is 3D Tetrahedron partition. This one is even harder since we can't easily visualize what happen in 3D space. So I chose to first work on the 3D Tmesh direction.</p>
<h3>3D Tmesh</h3>
<p>Till this Sunday, I have finish several function we need. The path along which I work on these function is pretty straightforward. First I think we need to come up with a way to visualize the boxes in 3D. I found the <em>patch</em> function in Matlab and implement a simple function to display a cube. One example with label is as follow</p>
<p>&lt;img src=&quot;/images/Research/Tmesh3D/reference.jpg&quot;&gt;</p>
<p>Then I need a function that can plot any number of cube partition together, which calls on the simple plot function. Since we will definitely need a 3D version of <em>reclist</em>, which I named it <em>cubelist</em>, I choose to use the output from the list function to plot the cubes.</p>
<p>In 3D there are a lot of possible output containing information about the whole partition that we may need. Thus I need to think carefully before I move on. We have 4 different dimension of objects: vertices, edges, faces and cubes (or boxes). First and foremost, given $\textbf{[nx, ny, nz]}$ as a parameter for the initial partition, we inevitably need to output the coordinate of each vertices, and that is $\textbf{[x,y,z]}$, three outputs. Second, we need to have the relation between cubes and vertices, cubes and edges, and also cubes and faces; they are three matrices, <strong>V</strong> of size $ncube$ by 8, <strong>E</strong> of size $ncube$ by 12 and <strong>F</strong> of size $ncube$ by 6. In these matrices, we use the vertices number, edge number and face number to represent each cube.</p>
<p>After that, we need the relation between edges and vertices, between faces and edges, and between faces and vertices. These matrices can help us quickly get the information we need. I named them as <strong>evertex</strong>, <strong>fedge</strong> and <strong>fvertex</strong>.</p>
<p>Finally, I think in the future, we also need some opposite relation, which are matrices that connect vertices and cubes, connect edges and cubes, and connect faces and cubes. They help me to find the cube that are arround a given vertex, edge or face. In addition, they can also be used to find the boundary vertices, edges and faces as we put zero for nothing (or boundary). I call these matrices <strong>vstar</strong>, <strong>estar</strong> and <strong>fstar</strong>.</p>
<p>All these output I chose is entirely based on my own experience. Therefore, after Professor Schumaker comes back, we decide whether to keep all of them and add some more, or dump some of them.</p>
<p>With these output, it's far more than enough to generate a plot of the whole partition. Here is a 3 by 3 by 4 partition, where the numbers are points on each side.</p>
<p>&lt;img src=&quot;/images/Research/Tmesh3D/cube1.jpg&quot;&gt;</p>
<p>It's possible to labe all of the object but that will be too cumbersome and messy especially when we get to more partition.</p>
<p>I have already finish the <em>cubelist</em> function now, and I decide to move on to the hard part, the <em>refinecube</em> function in next week. Wish me good luck!</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Ziqi Yang</p>
              <p class="site-description motion-element" itemprop="description">Welcome to my hub</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">34</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ziqi Yang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  







  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
