<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Welcome to my hub">
<meta property="og:type" content="website">
<meta property="og:title" content="Runner">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Runner">
<meta property="og:description" content="Welcome to my hub">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Runner">
<meta name="twitter:description" content="Welcome to my hub">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Runner</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Runner</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Hacking to the gate</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/26/Research-New-Start/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/26/Research-New-Start/" itemprop="url">Research-New-Start</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-26T17:19:10-05:00">
                2017-08-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="New-Beginning"><a href="#New-Beginning" class="headerlink" title="New Beginning"></a>New Beginning</h1><p>By the end of summer, my research project officially ended. In last week, cooperating with Shiying Li, PhD student in Math, we came up with a Tetrahedron adaptive program. I will summarize our work in last week in this note. </p>
<h2 id="T3adaptive"><a href="#T3adaptive" class="headerlink" title="T3adaptive"></a>T3adaptive</h2><p>In previous week, I have already finish this new refinement function named <em>refinetetra3</em> which will choose the largest boundary face and split it in 3 to get three new sub-tetrahedrons. Later in fall, I plan to finalize it so that it can split internal faces.</p>
<p>The remaining puzzles are interpolation functions, grid error evaluations and an error function to choose the tetrahedron to further refine. Luckily, these functions are just extensions from the 2D cases. And I have gathered enough experiences on them in 2D box project and 3D cube project. Therefore, it only took me 1 whole day to finish them.</p>
<p>After we have gathered all the tools, it’s finally the time to put everything up together. </p>
<p>In the first part of our big program,  we need to initialize the big partition. Other than reading from files like we did before, I also wrote a small initialization function to create Delaunay partition on 3D box of any size. </p>
<p>Then we use our good old friend, list function <em>tetralist</em> to get all the partition information we need. </p>
<p>Suppose we are given a target function, now that we have all the parts ready, we performed a first interpolation on the unrefine setting, which gives us a long coefficient vector $c$. Then we can start our main refinement process. </p>
<p>In each iteration, we did the following</p>
<ol>
<li>Based on the current coefficient, we calculate the error scaled by the volume in each tetrahedron using the error function. By error we mean the max error inside the tetrahedron. </li>
<li>Then we sort the error and find the largest 20% and store their indices in a list.</li>
<li>For every tetrahedron in the list, if it’s on the boundary, we use <em>refine3</em> to refine one of its boundary faces; if it’s a interior tetrahedron, we perform a Alfeld refinement using <em>refine4</em>.</li>
</ol>
<p>We predefined the number of iteration. If in an iteration we have the max error of all tetrahedron less than a very small number, say $10^{-5}$, we exit the loop.</p>
<p>After the loop, we use grid error evaluation to estimate the error and plot the final refinement.</p>
<p>In this refinement program, we can get exact result for any trivariate polynomial given that the degree of basis Bernstein polynomial is big enough, which is what the approximation theory shows.</p>
<p>Since we still haven’t found a nice way to displace 3D functions, I don’t have a nice plot to show here. </p>
<h2 id="New-Start"><a href="#New-Start" class="headerlink" title="New Start"></a>New Start</h2><p>As I mentioned, my research has officially over, but there are still lots of works that need to be done. So far no tetrahedron spline library exists and more functions are needed. </p>
<p>I have decided to continue working with Professor Schumaker on tetrahedron spline library in the fall semester. And I also plan to write a honor thesis on this topic to satisfy the requirement of graduating with honor in Math. </p>
<p>Since I have not enrolled in independent study or formally work as a RA, I can only use my spare time on this project. I will write a research note once every month instead of every week.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/24/Neural-Network-Note-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/24/Neural-Network-Note-1/" itemprop="url">Neural Network Note 1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-24T21:34:21-05:00">
                2017-08-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Basic-Neural-Network"><a href="#Basic-Neural-Network" class="headerlink" title="Basic Neural Network"></a>Basic Neural Network</h1><p>​    In last few months, I have taken 3 online courses on coursera and udemy about machine learning. Now I am going on a serious of deep learning course by <a href="https://lazyprogrammer.me/" target="_blank" rel="noopener">lazy programmer </a>. I do love this series a lot and I want to post some of my note on my blog. </p>
<h2 id="Forward-Propagation"><a href="#Forward-Propagation" class="headerlink" title="Forward Propagation"></a>Forward Propagation</h2><p>It’s quite a work to type the derivation and theory part in latex so I choose to just scratch the surface of them. </p>
<p>The first important function in the course is the <em>prediction</em> of a neural network using forward propagation. We create a 3 groups classification problem and predict the label use randomly initialized weight and bias. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line">Nclass = <span class="number">500</span> </span><br><span class="line"></span><br><span class="line">X1 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">0</span>,<span class="number">-2</span>])</span><br><span class="line">X2 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">X3 = np.random.randn(Nclass,<span class="number">2</span>) + np.array([<span class="number">-2</span>,<span class="number">2</span>])</span><br><span class="line">X = np.vstack([X1, X2, X3])</span><br><span class="line"></span><br><span class="line">Y = np.array([<span class="number">0</span>]*Nclass + [<span class="number">1</span>]*Nclass + [<span class="number">2</span>]*Nclass)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=Y, s = <span class="number">100</span>, alpha = <span class="number">.5</span>)</span><br><span class="line"><span class="comment"># plt.show()	</span></span><br><span class="line"></span><br><span class="line">D = <span class="number">2</span></span><br><span class="line">M = <span class="number">3</span></span><br><span class="line">K = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">W1 = np.random.randn(D,M)</span><br><span class="line">b1 = np.random.randn(M)</span><br><span class="line">W2 = np.random.randn(M,K)</span><br><span class="line">b2 = np.random.randn(K)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(X,W1,b1,W2,b2)</span>:</span></span><br><span class="line">	Z = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-X.dot(W1) - b1))</span><br><span class="line">	A = Z.dot(W2) + b2</span><br><span class="line">	expA = np.exp(A)</span><br><span class="line">	Y = expA / expA.sum(axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>)</span><br><span class="line">	<span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classification_rate</span><span class="params">(Y, P)</span>:</span></span><br><span class="line">	n_correct = <span class="number">0</span></span><br><span class="line">	n_total = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(Y)):</span><br><span class="line">		n_total +=<span class="number">1</span> </span><br><span class="line">		<span class="keyword">if</span> Y[i] == P[i]:</span><br><span class="line">			n_correct += <span class="number">1</span></span><br><span class="line">	<span class="keyword">return</span> float(n_correct) / n_total</span><br><span class="line"></span><br><span class="line">P_Y_given_X = forward(X,W1,b1,W2,b2)</span><br><span class="line">P = np.argmax(P_Y_given_X, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(len(P) == len(Y))</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Classification rate for randomly chosen weights:"</span>, classification_rate(Y,P))</span><br></pre></td></tr></table></figure>
<p>The code is pretty straightforward.</p>
<h2 id="Back-propagation"><a href="#Back-propagation" class="headerlink" title="Back propagation"></a>Back propagation</h2><p>The back propagation however, need some math derivation for the formula. </p>
<p>I really like the video “<em>The WRONG way to learn Backpropagation</em>“ in this course. People do not understand bp by just taking the difference between target and prediction and claim that multiplying this $\Delta$ with weight is somehow the derivative of the cost function. We find this by strict math derivation and observe the pattern then build this algorithm. The key is to expose the pattern yourself using gradient decent and substitute the repeating pattern. </p>
<h4 id="Some-Hardcore-Math"><a href="#Some-Hardcore-Math" class="headerlink" title="Some Hardcore Math"></a>Some Hardcore Math</h4><p>Suppose we are working on a multiclass classification problem with $K$ target classes.</p>
<p>Let’s say we have a cost function $L = \sum_n\sum_k t_k^n \log(y_k^n)$ where $n$ denotes the sampel number and $k$ is for all the class. This is the famous cross entropy function and I have also discussed it in my previous note <em>Beauty in Math</em>. </p>
<p>Suppose we have $D$ input features and 1 hidden layer with $M$ nodes. We use $W<em>{DM}$ and $V</em>{MK}$ to denote the weight between input layer and hidden layer and weights between hidden layer and output layer respectively. For simplicity, suppose there is no bias terms. And further assume that we are using sigmoid function as activation function on hidden layer and softmax function on output layer. </p>
<p>Now our goal is to derive $\frac{\partial L}{\partial V<em>{MK}}$ and $\frac{\partial L}{\partial W</em>{DM}}$. First apply chain rule<br>$$<br>\frac{\partial L}{\partial V_{mk}} = \sum<em>n \sum</em>{k’} t<em>{k’}^n \frac{1}{y</em>{k’}^n}\frac{\partial y<em>{k’}^n}{\partial V</em>{mk}}<br>$$<br>Note here $k’$ is not the same as $k$ and $V_{mk}$ denotes one entry in weight matrix $V$.</p>
<p>We know that<br>$$<br>y<em>{k’}^n = softmax(V</em>{K}^TZ) = \frac{\exp^{a_k}}{\sum_j \exp^{a_j}} \<br>a_k = V_K^T Z = \sum<em>m V</em>{mk} Z_m<br>$$<br>where $Z$ denote the output at the hidden layer. </p>
<p>If $k = k’$ , we have $\frac{\partial y_{k’}}{\partial a<em>k} = y</em>{k’}(1-y<em>k)$, and else $\frac{\partial y</em>{k’}}{\partial a<em>k} = -y</em>{k’}y<em>k$. So we can rewrite them using Kronecker Delta as<br>$$<br>\frac{\partial y</em>{k’}}{\partial a<em>k} = y</em>{k’}(\delta_{k’k} - y<em>k)<br>$$<br>Then<br>$$<br>\frac{\partial y</em>{k’}^n}{\partial V<em>{mk}} = \frac{\partial y</em>{k’}^n}{\partial a_{k}} \frac{\partial a<em>k}{\partial V</em>{mk}} =y<em>{k’}(\delta</em>{k’k} - y_k) Z<em>m<br>$$<br>So<br>$$<br>\begin{align}<br>\frac{\partial L}{\partial V</em>{mk}} &amp;= \sum<em>n \sum</em>{k’} t<em>{k’}^n \frac{1}{y</em>{k’}^n}y<em>{k’}^n(\delta</em>{k’k} - y_k^n) Z_m^n \<br>&amp;= \sum<em>n \sum</em>{k’} (t<em>{k’}^n \delta</em>{k’k} - t_{k’}^ny_k^n)Z_m^n \<br>&amp;= \sum_n (t<em>k^n - \sum</em>{k’} t_{k’}^ny_k^n )Z_m^n \<br>&amp;= \sum_n (t_k^n - y_k^n )Z_m^n<br>\end{align}<br>$$<br>since $\sum_k t_k \equiv 1$ as each sample belongs to only one class.</p>
<p>The derivation for $\frac{\partial L}{\partial W_{DM}}$ is just some additional work. Since we have<br>$$<br>Z<em>M = \frac{1}{1 + \exp^{-W</em>{MK}^TX}}<br>$$<br>we can easily derive that<br>$$<br>\begin{align}<br>\frac{\partial L}{\partial W_{dm}} &amp; = \sum_n (t_k^n - y_k^n ) \frac{\partial Z<em>m^n}{\partial W</em>{dm}} \<br>&amp; = \sum_n (t_k^n - y_k^n )Z_m^n (1-Z_m^n)X_d^n<br>\end{align}<br>$$<br>The pattern here is actually already visiable. If we have one more hidden layer with same activation function, all we need to do is just to replace $X_d^n$ with the hidden value and multiply by addition factors. Because of the recursive nature of derivatives, back propagation is able to handle any deep neural network. </p>
<p>When putting these into code, we definitely want to vectorize them. It’s pretty easy to make mistake as there are so many matrices to keep track of. One easy way I use to double check is to check the size of the matrix. Make sure their inner sizes match and the output size is the same as the target weight.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><p>In this code example, we keep working on the previous three groups problem.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forward</span><span class="params">(X,W1,b1,W2,b2)</span>:</span></span><br><span class="line">	Z = <span class="number">1</span> / (<span class="number">1</span> + np.exp(-X.dot(W1)-b1))</span><br><span class="line">	A = Z.dot(W2) + b2</span><br><span class="line">	expa = np.exp(A)</span><br><span class="line">	Y = expa / expa.sum(axis = <span class="number">1</span>, keepdims = <span class="keyword">True</span>)</span><br><span class="line">	<span class="keyword">return</span> Y, Z</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classification_rate</span><span class="params">(Y,P)</span>:</span></span><br><span class="line">	n_correct = <span class="number">0</span></span><br><span class="line">	n_total = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(Y)):</span><br><span class="line">		n_total += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> Y[i] == P[i]:</span><br><span class="line">			n_correct += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> float(n_correct) / n_total</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cost</span><span class="params">(T, Y)</span>:</span></span><br><span class="line">	tot = T * np.log(Y)</span><br><span class="line">	<span class="keyword">return</span> tot.sum()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_w2</span><span class="params">(Z, T, Y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> Z.T.dot(T - Y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_b2</span><span class="params">(T,Y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> (T-Y).sum(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_w1</span><span class="params">(X, Z, T, Y, W2)</span>:</span></span><br><span class="line">	dZ = (T - Y).dot(W2.T) * Z * (<span class="number">1</span> - Z)</span><br><span class="line">	<span class="keyword">return</span> X.T.dot(dZ)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">derivative_b1</span><span class="params">(T, Y, W2, Z)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> ((T-Y).dot(W2.T) * Z * (<span class="number">1</span>-Z)).sum(axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">	Nclass = <span class="number">500</span></span><br><span class="line">	D = <span class="number">2</span> <span class="comment"># input</span></span><br><span class="line">	M = <span class="number">3</span> <span class="comment"># hidden layer</span></span><br><span class="line">	K = <span class="number">3</span> <span class="comment"># output</span></span><br><span class="line"></span><br><span class="line">	X1 = np.random.randn(Nclass,D) + np.array([<span class="number">0</span>,<span class="number">-2</span>])</span><br><span class="line">	X2 = np.random.randn(Nclass,D) + np.array([<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">	X3 = np.random.randn(Nclass,D) + np.array([<span class="number">-2</span>,<span class="number">2</span>])</span><br><span class="line">	X = np.vstack([X1, X2, X3])</span><br><span class="line"></span><br><span class="line">	Y = np.array([<span class="number">0</span>]*Nclass + [<span class="number">1</span>]*Nclass + [<span class="number">2</span>] * Nclass)</span><br><span class="line">	N = len(Y)</span><br><span class="line"></span><br><span class="line">	T = np.zeros((N,K))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(N):</span><br><span class="line">		T[i,Y[i]] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	<span class="comment"># plt.scatter(X[:,0], X[:,1], c=Y, s=100, alpha=.5)</span></span><br><span class="line">	<span class="comment"># plt.show()</span></span><br><span class="line"></span><br><span class="line">	W1 = np.random.randn(D, M)</span><br><span class="line">	b1 = np.random.randn(M)</span><br><span class="line">	W2 = np.random.randn(M, K)</span><br><span class="line">	b2 = np.random.randn(K)</span><br><span class="line"></span><br><span class="line">	learning_rate = <span class="number">10e-7</span></span><br><span class="line">	costs = []</span><br><span class="line">	<span class="keyword">for</span> epoch <span class="keyword">in</span> range(<span class="number">100000</span>):</span><br><span class="line">		output, hidden = forward(X,W1,b1,W2,b1)</span><br><span class="line">		<span class="keyword">if</span> epoch % <span class="number">100</span> == <span class="number">0</span>:</span><br><span class="line">			c = cost(T, output)</span><br><span class="line">			P = np.argmax(output, axis = <span class="number">1</span>)</span><br><span class="line">			r = classification_rate(Y,P)</span><br><span class="line">			print(<span class="string">"epoch"</span>, epoch, <span class="string">"cost"</span>, c, <span class="string">"classification rate:"</span>,r)</span><br><span class="line">			costs.append(c)</span><br><span class="line"></span><br><span class="line">		W2 += learning_rate *  derivative_w2(hidden, T, output)</span><br><span class="line">		b2 += learning_rate *  derivative_b2(T, output)</span><br><span class="line">		W1 += learning_rate *  derivative_w1(X, hidden, T, output, W2)</span><br><span class="line">		b1 += learning_rate *  derivative_b1(T, output, W2, hidden)</span><br><span class="line"></span><br><span class="line">	plt.plot(costs)</span><br><span class="line">	plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	main()</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/13/Research-Note-9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/13/Research-Note-9/" itemprop="url">Research-Note-9</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-13T12:00:14-05:00">
                2017-08-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-9"><a href="#Research-Note-9" class="headerlink" title="Research Note 9"></a>Research Note 9</h1><p>This week we mainly work on the tetrahedron project. Besides those little helper functions, I implemented two new main components of our project.</p>
<p>First is another new refine function. We have decided to renamed the previous refine function of tetrahedrons. The new one split a tetrahedron into 3 new tetrahedrons by finding the largest facet and its center point, and connect the opposite vertex to that center point to insert 3 new internal faces. In that way an old tetrahedron is splited into 3. </p>
<p>The implementation is quite similar to the previous function and only took me one day to finish this function. </p>
<p><img src="/images/Research/Tetra/refine3.jpg" width="500"></p>
<p>Here is a demonstration of the refinement. </p>
<h2 id="Stochastic-Walk"><a href="#Stochastic-Walk" class="headerlink" title="Stochastic Walk"></a>Stochastic Walk</h2><p>Another function is called stochastic walk. In the final stage of our project, we will have many points in our large tetrahedron partition, and we need to locate each point, aka, find the tetrahedron contain a given point. </p>
<p>Matlab has a built in function called pointLocation, which should accomplish that. However, I tested it with some simple cases and find that it fail in some. I have posted a question on the MathWork forem but receive no response so far. </p>
<p>So we decide to implement our own pointLocation function. The very first and foremost idea is to use the barycentric coordinate’s property. If a point is located inside a tetrahedron then the barycentric coordinate of that point relative to that tetrahedron will have all positive components. However, this means we need to calculate the barycentric coordinate of a point for all the tetrahedron. This is too inefficient. </p>
<p>Another way is to build a K-D tree and search on the branch. However, K-D tree fails in some cases, e.g. triangulation with holes in it. </p>
<p>I did some research on Google and found a paper introducing some nice way to find point location. The paper is called <em>Walk in a Triangulation</em> by Olivier, etc. It can be found <a href="https://hal.inria.fr/inria-00072509/document" target="_blank" rel="noopener">here</a>.</p>
<p>In the paper, there are 4 different ways to find point location. The idea is quite similar. Start from a tetrahedron, according to some condition, move to next tetrahedron and so on, and finally stop in the target tetrahedron. </p>
<p>I choose to implement the Stochastic Walk as it’s easier to implement and we have the available helper functions. It starts from a random tetrahedron. Choose a random facet of it, and check whether the point is on the other side of the facet. If so, move to the next tetrahedron sharing that facet; if not, move to another facet of the current tetrahedron. In the mean time, it also ‘remember’ the last tetrahedron visited so that we won’t ends up in an infinite loop in a pair of tetrahedron. </p>
<p>There are also some other little details, but I don’t want to discuss it here. </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/05/Research-Note-8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/05/Research-Note-8/" itemprop="url">Research-Note-8</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-08-05T16:34:22-05:00">
                2017-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/Tetra-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">Tetra-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-8"><a href="#Research-Note-8" class="headerlink" title="Research Note 8"></a>Research Note 8</h1><p>This week, I continued to work on the tetrahedron project and implement several functions. </p>
<h2 id="Refine1"><a href="#Refine1" class="headerlink" title="Refine1"></a>Refine1</h2><p>The refine1 function that I started last week is pretty tricky. There are many edge cases but fortunately I have finished it. </p>
<p>As mentioned in last note, the way this function works is to find the longest edge of the target tetrahedron and use an internal face to split that edge and also the whole tetrahedron into two smaller ones. These two smaller tetrahedron will always have same volume and share a face. </p>
<p>The hard part about this function is to keep track of all other list information. For example, after we insert an interior face, we create some two subedges of the longer edge which we split, and we also add two edges on the other two faces. If a neighbor tetrahedron has been refined before, then some of these new edges may already exist, so we have to first check their existence and then update or insert new information. Same process has to be applied to all the list information we keep. </p>
<p>Another tricky part is the orientation of all the list. For instance, we keep track of a #tetra by 6 matrix for all the edges of each tetrahedron. In order to obtain the right coefficient of spline when we later implement other functions, we need to keep an order among edges of a tetrahedron. So when new edges come, we have to maintain the order. </p>
<p>I don’t want to explain all the details here. The final result is promising. </p>
<h2 id="Refine3"><a href="#Refine3" class="headerlink" title="Refine3"></a>Refine3</h2><p>On Wednesday, I met with the Professor. After our discussion, we thought a more common way to refine a tetrahedron is to split it into four smaller tetrahedron by connecting each vertex to the center of the original tetrahedron. So I start to work on a new function to accomplish that. </p>
<p>To be honest, this one is easier than refine1. Since all the new vertex, new edges, and new faces are inside the refined tetrahedron, I no longer need to check their existence and separate the cases. Though orientation is still a problem, with experience in refine1, I successfully implemented this function in this week. </p>
<p>The way we initialize a partition is always reading from files. It’s a simple fact that a cube can be partitioned into 5 tetrahedron, 4 of which are identical and one in the middle, as the following diagram shows.</p>
<p><img src="/images/Research/Tetra/tetra0.jpg" width="500"></p>
<p>After we refine the first tetrahedron using refine3 the output will be like:</p>
<p><img src="/images/Research/Tetra/tetra1.jpg" width="500"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/30/Research-Note-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/30/Research-Note-7/" itemprop="url">Research-Note-7</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-30T20:01:42-05:00">
                2017-07-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh3D/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh3D</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-7"><a href="#Research-Note-7" class="headerlink" title="Research Note 7"></a>Research Note 7</h1><p>This week I first put the 3d function pieces together to make a adaptive refinement code penalizing with C0 smoothness condition. The whole program is based on the 2d version that Professor Schumaker wrote. </p>
<h2 id="Tadpat03d"><a href="#Tadpat03d" class="headerlink" title="Tadpat03d"></a>Tadpat03d</h2><p>The program is called Tadapt03d, where T for tensor product, adapt0 means adaptive fitting with C0 smoothness and 3d indicates that it’s on 3d cubes. </p>
<p>Same as usual, the program begins with calling the list function reclist2 to get list of information of the partition. And a function handler is created, which is our target function to approximate. </p>
<p>It then called the <em>interpdp03d</em> function to interpolate the given function f with C0 smoothness condition enforced. The <em>tsp0smooth3d</em> function, which return the smoothness condition matrix M, is called inside the <em>interpdp03d</em> function. Now that we obtain the coefficient vector $c$, we start to refine. </p>
<p>The criterial is to calculate the error of approximation in each unit cube, and find the biggest 20% of all the cube to further refine. I wrote an error calculating function called <em>rerr13d</em>, which gives the errors in each cube. We then refine those cubes with large error. I would prefer to call them a single <em>batch</em>. After we refine all the cube in the batch, we call the <em>interpdp03d</em> function again to obtain the new coefficient vector $c$. Then we start another iteration. </p>
<p>The number of <em>batches</em> or level of refinement is given by user input. </p>
<p>We still haven’t found a good way to visualize 3d functions so now I can only use error to check my program. </p>
<p>One thing to notice, at this point the <em>tsp0smooth3d</em> function is actually half-complete. As mention in last note, there are at least four cases in 3d C0 smoothness condition. I still haven’t figure out the right way to put in hanging edges and hanging vertices on multiple edges. So the function actually miss some of the condition. </p>
<h2 id="Tetra-mesh"><a href="#Tetra-mesh" class="headerlink" title="Tetra-mesh"></a>Tetra-mesh</h2><h3 id="Plot-and-readfile"><a href="#Plot-and-readfile" class="headerlink" title="Plot and readfile"></a>Plot and readfile</h3><p>On the other hand, I have started the tetrahedron project. This one will be the final project of this summer, and I believe it will be more challenging than the previous two. </p>
<p>As I did in the previous two projects, I started by looking for a way to visualize  tetrahedrons. The function <em>patch</em> is still a reasonable choice. As I learn from visualizing cubes, I did basically the same — wrote a function to plot all the tetrahedrons given a matrix of points and a matrix of vertices of each tetra. </p>
<p>For tetrahedron, it’s more like the 2d triangle case. It’s hard to just initialize a bunch of tetras with few arguments. So I prefer to read in the files like Professor Schumaker did in his splinepak. I wrote a <em>readtetra</em> function to read in formatted tetrahedron data and get the basic information about the tetrahedron group. </p>
<h3 id="List-function"><a href="#List-function" class="headerlink" title="List function"></a>List function</h3><p>Now that I’ve got a working plot function and a read file function, I move on to the first cornerstone — list function. </p>
<p>Similar to both the cubelist and trilist case, I need to get all the needed information based on the very basic list I read from files. Specifically, I need a matrix E for tetra edge relation, a matrix F for tetra face relation, a matrix evertex for edge vertex relation, a matrix fvertex for face vertex relation and so on. </p>
<p>One tricky thing that’s unique for tetrahedrons is their orientations. For rectangles and cubes, it’s pretty easy to figure out how to put the edges and vertices in order. But for tetrahedron, so far I haven’t get a nice and easy way to do the same. </p>
<p>I’ve tried to orient the edges in such a way that three edges of one face go first in an order that obey the right hand rule, and then the other three edges go next with same order. But later in my refine function, things become more complicated and I decide to leave such idea behind now. </p>
<p>It took me about two days or so to get a nice working list function. </p>
<h3 id="Refine1"><a href="#Refine1" class="headerlink" title="Refine1"></a>Refine1</h3><p>A tetrahedron can be refined in several ways, one into two, three or four. I started with the easiest, find the longest edge and use a interior face to split the edge and the whole tetra into two small ones.</p>
<p>I am still working on this function. There are some tricky place that needs to be handled. I believe by next week, I will have a nice working refine1 funcion ready.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/23/Research-Note-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/23/Research-Note-6/" itemprop="url">Research-Note-6</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-23T16:06:47-05:00">
                2017-07-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh3D/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh3D</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-6"><a href="#Research-Note-6" class="headerlink" title="Research Note 6"></a>Research Note 6</h1><p>This week we debug the 2d code and keep working on 3d functions. </p>
<p>In 2d case, Professor Schumaker came up with a function to add C1 smoothness condition between rectangles. This function makes use of recl and rec, vectors denoting the rectangles on the left and right of each edge. Unfortunately, due to the way we develop refinerec, there is quite a few bugs in the function. So I spent rought two days on debugging the refinerec function and finally get a version that pass enormous test cases. </p>
<h2 id="Interdp3d-and-Valtspgrid3d"><a href="#Interdp3d-and-Valtspgrid3d" class="headerlink" title="Interdp3d and Valtspgrid3d"></a>Interdp3d and Valtspgrid3d</h2><p>On the 3d side, I develop some functions as the extensions of their 2d correspondences. Two of them are interdp3d and valtspgrid3d. </p>
<p>Interdp3d interpolate a given function on the whole rectangulation and return the coefficient as a 3d Matrix. Since Matlab does not support nested list structure, we look to <em>tensor toolbox</em> for help. A tensor is just a n dimension matrix. The toolbox include basic functionality such as addition, subtraction, scalar multiplication and scalar division. It also supports multiplication between tensor and matrix on a given direction. That’s what we mainly use. </p>
<p>Back to my functions. Interdp3d returns a 3d tensor storing the coefficient of the 3d spline on the rectangulation. Then I use valtspgrid0 to obtain approximation of values of the given function at 3d grid points using the coefficient we get. To varify the result, I compute the norm of error terms. </p>
<p>We haven’t found a good way to visualize the function. So far we have try to plot the isosurface. There is a nice package on MathWork forem named sliceomatic. It gives a live isosurface plot, but it still does not meet our expectation.</p>
<h2 id="Other-functions"><a href="#Other-functions" class="headerlink" title="Other functions"></a>Other functions</h2><p>Since my refinecube function only returns lists of relation among cubes, faces, edges and vertices, I need to find a way to get the other indispensible information such as the hanging vertices, subedges, etc. </p>
<p>So I wrote a bunch of small helper functions, like gethv for get hanging vertex, getse for get subedges, getsf for get subfaces and gethe for get hanging edges. Some of the cases are pretty tricky, for example in 3d a vertex can be hanging on multiplt edges. </p>
<p>Now that I prefer not to update these other important list in the refinement function, that function will definitely be less error-prone. However, in the view of efficiency, separating them out will without doubt be slower. So far it has not been a problem. </p>
<h2 id="tsp0smooth3d"><a href="#tsp0smooth3d" class="headerlink" title="tsp0smooth3d"></a>tsp0smooth3d</h2><p>Now I am currently working on the tsp0smooth3d function. It enforces the C0 smoothness condition on the 3d partition. Compared to the 2d tsp0smooth I implemented half month ago, this one is much more complicated. In 2d, only two cases are in consideration, hanging vertices and subedges. On the other side, in 3d, there are at least 4 cases, hanging vertices, hanging edges, subedges and subfaces. And each cases is much harder to implement, since we have higher degree of Bernstein basis polynomial. </p>
<p>It’s not that easy to describe the problem I ran into while implementing this code. The vital issue is that I cannot just easily visualize the work. Most of the cases need pure imagination. When 3d is involved, things always get more complicated. </p>
<p>I hope I can finish it in few days next week. </p>
<h2 id="P-S"><a href="#P-S" class="headerlink" title="P.S."></a>P.S.</h2><p>One interesting and weird thing I noticed about Matlab is its meshgrid function. In 3d cases, one needs to do </p>
<p>​                <code>[X,Y,Z] = meshgrid(ty,tx,tz)</code></p>
<p>to get the correct mesh in 3d, where ty, tx, tz are generated using linspace on their corresponding direction. Notice the weird order of argument. I am still wondering why these people prefers to pass the argument in this way. Just because of this ordering, I spent 2 more hours debugging my code. </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/15/Research-Note-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/15/Research-Note-5/" itemprop="url">Research-Note-5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-15T12:38:58-05:00">
                2017-07-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-5"><a href="#Research-Note-5" class="headerlink" title="Research Note 5"></a>Research Note 5</h1><p>I was seriously ill last week so I haven’t worked a lot and updated my Research Note. </p>
<p>This two week I keep working on the T-mesh 3D functions. By today, I have finished the cubelist and refinecube function. These two function corresponds to those in 2D case, a.k.a. reclist and refinerec. In particular, refinecube is much more complicated than refinerec so I took a completely different approach on writing it. I wrote three helper functions to update information about vertices, edges and faces respectively. </p>
<p>Other than the 3d functions, now that we have finish most part of 2d cases, we can finally create some sophisticated program on top of these Bernstein basis polynomial on rectangulation. </p>
<p>For example, in this week, Professor Schumaker had come up with an adaptive fitting program using the functions we have written last month. </p>
<p>The program fit a function on a rectangulation, calculate the error in each iteration and refine those rectangles that will decrease the error in greatest extent. </p>
<p>An output case: </p>
<p>​    For fitting function<br>$$<br>f(x,y) = \tanh(40y-80x^2)-\tanh(40x-80y^2)<br>$$<br>with a initial 5 by 5 rectangulation using Bernstein basis polynomial of degree 5 on both direction and with a 50 level adaptive fitting, we get the final rectangulation as</p>
<p><img src="/images/Research/Tmesh/adapt1.jpg" width="500"></p>
<p>The function plot and the error plot are</p>
<p><img src="/images/Research/Tmesh/adapt2.jpg" width="500"></p>
<p><img src="/images/Research/Tmesh/adapt3.jpg" width="500"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/02/Research-Note-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/02/Research-Note-4/" itemprop="url">Research-Note-4</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-07-02T15:10:06-05:00">
                2017-07-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-4"><a href="#Research-Note-4" class="headerlink" title="Research Note 4"></a>Research Note 4</h1><p>This week my Professor Schumaker left for a conference, and won’t be back until next Friday. Before leaving, he has assigned me several tasks. </p>
<h2 id="Tmesh-Functions"><a href="#Tmesh-Functions" class="headerlink" title="Tmesh Functions"></a>Tmesh Functions</h2><p>The very imminent one is to continue work on the Tmesh functions. We need a function to perform penalize least square approximation on refined rectangulations. It consists of two major steps: </p>
<ol>
<li>Getting the smoothness condition between unit rectangles.</li>
<li>Perform penalize least square approximation.</li>
</ol>
<h3 id="Smoothness-Condition-Matrix"><a href="#Smoothness-Condition-Matrix" class="headerlink" title="Smoothness Condition Matrix"></a>Smoothness Condition Matrix</h3><p>Since we have refining our rectangles, we may have very weird partition of the original domain region. In order to obtain a smooth surface after we approximate a function, we need to calculate the smoothness condition on sharing edges and sharing vertices. </p>
<p>The idea is not very complicate. First, we obtain the number of smoothness condition $ns$ we need by counting sharing edges and sharing vertices. The formula also involves the dimensions on x, y directions. </p>
<p>Then we construct a $ns$ by $nc$ zero matrix, where $nc$ here is the number of coefficient for a spline on the rectangulation. We can use the <em>sparse</em> function in Matlab to save storage space, since the smoothness condition only involves the coefficients on the same edge. </p>
<p>To get the value at specific entry, we need to traverse all the shared edges and hanging vertices. Note the order we put the smoothness condition in each row does not matter, because when we enforce the condition, we will simply do it by minimize the product of $cM$ where $c$ is the spline coefficient and $M$ is our matrix.</p>
<p>As we have different degree of polynomial on different direction, I chose to first traverse all the horizontal edge and then vertical. In each iteration, I get all the coefficients of domain points on the current edge, and then solve for a linear system. This system represent the fact that the Bernstein polynomial on different side of the edge reach the same value on the domain points. In other words, this is also a interpolation problem, where I represent the coefficient of the Bernstein polynomial using the coefficient on the other side. We basically do the same on all the hanging vertices. </p>
<p>Finally, the function return the well-constructed matrix $M$ as output.</p>
<h3 id="Penalize-Least-Square-Approximation"><a href="#Penalize-Least-Square-Approximation" class="headerlink" title="Penalize Least Square Approximation"></a>Penalize Least Square Approximation</h3><p>This function is a little similar to the one that interpolate any given function, except for the fact that we are solving least square fitting problem accompany with smoothness condition. </p>
<p>I have finished the outline of the function and there is a problem that I have to wait till Professor get back. Basically I have to use the Kronecker product of Bernstein polynomial to get the linear system. I will add details about this function in next Research Note.</p>
<h3 id="Refinerec"><a href="#Refinerec" class="headerlink" title="Refinerec"></a>Refinerec</h3><p>In addition to the two functions above, I also spent two whole days on debugging and fixing <em>refinerec</em> function. </p>
<p>Professor notice a significant bug on the previous version. It’s pretty complicated to articulate the bug. I added 250 lines and finally fixed it. Now the whole refine function is 750 line, but I believe I could have combine some of the cases or extract out some helper functions to make the whole code more readable.</p>
<h2 id="Other-Directions"><a href="#Other-Directions" class="headerlink" title="Other Directions"></a>Other Directions</h2><p>Other than the Tmesh functions that I need to work on, Professor pointed two direction for me in the next two weeks. First is the 3D version of the Tmesh problems. In other words, I need to extend our current work on 2D to 3D. We both know that I will be a huge amount of work, so he only expects me to first get all the geometric functions. </p>
<p>The other direction is 3D Tetrahedron partition. This one is even harder since we can’t easily visualize what happen in 3D space. So I chose to first work on the 3D Tmesh direction. </p>
<h3 id="3D-Tmesh"><a href="#3D-Tmesh" class="headerlink" title="3D Tmesh"></a>3D Tmesh</h3><p>Till this Sunday, I have finish several function we need. The path along which I work on these function is pretty straightforward. First I think we need to come up with a way to visualize the boxes in 3D. I found the <em>patch</em> function in Matlab and implement a simple function to display a cube. One example with label is as follow</p>
<p><img src="/images/Research/Tmesh3D/reference.jpg"></p>
<p>Then I need a function that can plot any number of cube partition together, which calls on the simple plot function. Since we will definitely need a 3D version of <em>reclist</em>, which I named it <em>cubelist</em>, I choose to use the output from the list function to plot the cubes. </p>
<p>In 3D there are a lot of possible output containing information about the whole partition that we may need. Thus I need to think carefully before I move on. We have 4 different dimension of objects: vertices, edges, faces and cubes (or boxes). First and foremost, given $\textbf{[nx, ny, nz]}$ as a parameter for the initial partition, we inevitably need to output the coordinate of each vertices, and that is $\textbf{[x,y,z]}$, three outputs. Second, we need to have the relation between cubes and vertices, cubes and edges, and also cubes and faces; they are three matrices, <strong>V</strong> of size $ncube$ by 8, <strong>E</strong> of size $ncube$ by 12 and <strong>F</strong> of size $ncube$ by 6. In these matrices, we use the vertices number, edge number and face number to represent each cube. </p>
<p>After that, we need the relation between edges and vertices, between faces and edges, and between faces and vertices. These matrices can help us quickly get the information we need. I named them as <strong>evertex</strong>, <strong>fedge</strong> and <strong>fvertex</strong>. </p>
<p>Finally, I think in the future, we also need some opposite relation, which are matrices that connect vertices and cubes, connect edges and cubes, and connect faces and cubes. They help me to find the cube that are arround a given vertex, edge or face. In addition, they can also be used to find the boundary vertices, edges and faces as we put zero for nothing (or boundary). I call these matrices <strong>vstar</strong>, <strong>estar</strong> and <strong>fstar</strong>. </p>
<p>All these output I chose is entirely based on my own experience. Therefore, after Professor Schumaker comes back, we decide whether to keep all of them and add some more, or dump some of them. </p>
<p>With these output, it’s far more than enough to generate a plot of the whole partition. Here is a 3 by 3 by 4 partition, where the numbers are points on each side.</p>
<p><img src="/images/Research/Tmesh3D/cube1.jpg"></p>
<p>It’s possible to labe all of the object but that will be too cumbersome and messy especially when we get to more partition.</p>
<p>I have already finish the <em>cubelist</em> function now, and I decide to move on to the hard part, the <em>refinecube</em> function in next week. Wish me good luck!</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/23/Research-Note-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/23/Research-Note-3/" itemprop="url">Research-Note-3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-23T13:38:05-05:00">
                2017-06-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Research Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Research-Note/T-mesh/" itemprop="url" rel="index">
                    <span itemprop="name">T-mesh</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Research-Note-3"><a href="#Research-Note-3" class="headerlink" title="Research Note 3"></a>Research Note 3</h1><p>This week, we finally get into the meat, spline. After I have got the basic geometric functions to work, we can move on to evaluate splines on rectangulations. </p>
<h2 id="Interpolating-Functions"><a href="#Interpolating-Functions" class="headerlink" title="Interpolating Functions"></a>Interpolating Functions</h2><p>As I have discussed in the last Research Note, a spline on the rectangulation is stored as a long coefficient vector. That vector is separated into three chunks for vertices, edges and interior domain points respectively. But  where are these coefficients coming from? How are we going to interpolate functions on rectangulation?</p>
<p>Similar to what happens on triangulation in 2D space, we construct the coefficient vectors by looping over all the unit rectangles, calculate the coefficient, and put it in the right place in long vector $c$.</p>
<p>We solve the interpolation problem same as we did in any other cases, except we are using Bernstein polynomial as basis functions. First I use a function to calculate all the value of Berstein polynomial on $d+1$ equally spaced point on $[0,1]$ to get a matrix $B$, where $d$ is the degree of the $x$-direction polynomial. Same operation for $y$ direction and I get another matrix $\widetilde{B}$ using $\widetilde{d}$, the dimension for $y$-direction polynomial. Then I calculate the value of the target function $f$ at the $(d+1)\times (\widetilde{d}+1)$ grid points to get a value matrix $V$. Finally I solve the linear system to get the coefficient matrix $C$.<br>$$<br>B\times C \times\widetilde{B} = V<br>$$<br>After I got the right coefficient, I use the function <em>getindex</em> to find the index of $c$ to put the coefficient in. And all that above is the first major function I worked on this week. It’s named <em>interdp</em> for interpolating domain points.  </p>
<p>Note, here our work can only handle functions on a rectangulation without a hanging vertex. For refinement of rectangulation, we need to construct smoothness conditions and solve for the corresponding coefficients. That will be the major part of my work next week.</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>A quick small example. Suppose we are interpolating function $f$ with $d=3$ and $\widetilde{d}=4$ on unit square.<br>$$<br>f = x^2 + 2y^3<br>$$<br>The result plot on the 3 by 3 rectangulation is </p>
<p><img src="/images/Research/Tmesh/interdp.jpg" width="500"></p>
<p>And the root mean square error of the resulting surface is $1.7\times 10^{-16}$.</p>
<h2 id="Interpolation-of-Partial-Derivatives"><a href="#Interpolation-of-Partial-Derivatives" class="headerlink" title="Interpolation of Partial Derivatives"></a>Interpolation of Partial Derivatives</h2><p>After I tackle the problem of interpolate a general function on the rectangulation. I start to work on the partial derivatives of a general function. </p>
<p>I start by experimenting on a tensor product Bezier patch, or just a rectanlge with Bernstein basis polynomial. Solving the interpolation problem for the partial derivative of a function is equivalent to taking the partial derivative of the Bernstein basis polynomial and adjust the coefficients. </p>
<p>With basic linear algebra, one can easily find out that differentiating a matrix of basis function is same as multiplying a forward difference matrix. Since the interpolation solution is given by the product of three matrices, we can do the forward difference on any one that contains the variables. Professor Schumaker prefers to compute a lower degree Bernstein basis polynomial matrix and do the forward difference on the coefficient matrix $C$. </p>
<p>Eventually, we want to have a function that can give the values of the partial derivatives of any degree of a function on a grid. That will be another task for me in next week.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/18/Clustering/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Ziqi Yang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Runner">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/18/Clustering/" itemprop="url">Clustering</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-06-18T23:45:57-05:00">
                2017-06-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study-Note/" itemprop="url" rel="index">
                    <span itemprop="name">Study Note</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Study-Note/Machine-Learning/" itemprop="url" rel="index">
                    <span itemprop="name">Machine Learning</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Clustering"><a href="#Clustering" class="headerlink" title="Clustering"></a>Clustering</h1><p>Clustering is a unsupervised learning technique to find subgroups or <em>clusters</em> in a data set. </p>
<p>Comparing with PCA:</p>
<ul>
<li>PCA looks to find a low-dimensional representation of the observations that explain a good fraction of the variance.</li>
<li>Clustering looks to find homogeneous subgroups among the observations.</li>
</ul>
<p>The two most famous clustering techniques are <em>K-means clustering</em> and <em>hierarchical clustering</em>. In K-means, we seek to partition the observations into predefined number of clusters. In hierarchical clustering, we do not know in advance how many clusters will there be; we end up with a tree-like visual representation of the observations, called <em>dendrogram</em>.</p>
<h2 id="K-Means-Clustering"><a href="#K-Means-Clustering" class="headerlink" title="K-Means Clustering"></a>K-Means Clustering</h2><p>It partitions the observations into k non-overlapping clusters. Need to specify $K$ first. Let $C_1,C_2,…,C_k$ be sets containing the indices of data in each cluster. Then they are exhaustive and mutually exclusive. We want the <em>within-cluster variance</em> to be as small as possible, which is denoted by $W(C_i)$.</p>
<p>Finding K-means clustering is the same as solving problem:<br>$$<br>minimize{\sum_{k=1}^K W(C_k) }<br>$$<br>By far the most common way to define $W(C_i)$ is using squared Euclidean distance, by</p>
<p>$$<br>W(C_k) = \frac{1}{|C<em>k|}\sum</em>{i,i’\in C<em>k}\sum</em>{j=1}^p(x<em>{ij}-x</em>{i’j’} )^2<br>$$<br>where $p$ is the dimension of the feature space.</p>
<p>Solving the above minimization problem is pretty hard. Fortunately, there is a simple algorithm that gives a pretty good solution:</p>
<p>— Algorithm:</p>
<ol>
<li>Randomly assign a number from 1 to $K$ to each of the observations. These are the initial cluster assignments</li>
<li>Iterate until the cluster assignments stop changing:<ol>
<li>For each of the $K$ clusters, compute the cluster <em>centroid</em>. The kth cluster centroid is the vector of the $p$ feature means for the observations in that cluster.</li>
<li>Assign each observations to the cluster whose centroid is closest in the context of Euclidean distance.</li>
</ol>
</li>
</ol>
<p>This algorithm guarantees to decrease the target sum at each step and it will finally reach a local optimum. Since the algorithm doesn’t ensure a global optimum, it’s important to run the algorithm with multiple times with different random initial configuration.</p>
<p>In addition, selecting the number $K$ is also a difficult problem.</p>
<h2 id="Hierarchical-Clustering"><a href="#Hierarchical-Clustering" class="headerlink" title="Hierarchical Clustering"></a>Hierarchical Clustering</h2><p>The most common type of hierarchical clustering is <em>bottom-up</em> or <em>agglomerative</em> clustering. It means to build the dendrogram from the leaves and combining clusters up to the trunk. </p>
<p>To interpret the dendrogram, just remember observations that are similar muse at the bottom and those that are quite different muse much later. Location of leaves means nothing.</p>
<p>To identify clusters in dendrogram, horizontally cut the tree and find the branches. Cut at different height may give different number of clusters. A dendrogram can be used to obtain any number of clusters.</p>
<p>— Algorithm</p>
<ol>
<li>Begin with n observations and a measure (e.g. Euclidean distance) of all the n(n-1)/2 pairwise dissimilarities. Each of the n observations is treated as its own cluster.</li>
<li>Fuse the two most similar till there is only one cluster left. The dissimilarity between the most similar two indicates the height at which the fusion should be taken.</li>
</ol>
<p>For this algorithm to work, need to extend dissimilarity to between groups of observations. Use the notion of <em>linkage</em>. </p>
<p>4 types of linkage:</p>
<ol>
<li>Complete: maximal intercluster dissimilarity</li>
<li>Single: minimal intercluster dissimilarity</li>
<li>Average: mean intercluster dissimilarity</li>
<li>Centroid; dissimilarity between the centroids</li>
</ol>
<h2 id="Issues-for-Clustering"><a href="#Issues-for-Clustering" class="headerlink" title="Issues for Clustering"></a>Issues for Clustering</h2><h4 id="Small-Decisions-with-Big-Impacts"><a href="#Small-Decisions-with-Big-Impacts" class="headerlink" title="Small Decisions with Big Impacts"></a>Small Decisions with Big Impacts</h4><ul>
<li>For hierarchical clustering, <ul>
<li>What dissimilarity measure to use?</li>
<li>What type of linkage?</li>
<li>Where should we cut the dendrogram to obtain the clusters?</li>
</ul>
</li>
<li>For K-means clustering<ul>
<li>What value of $K$?</li>
</ul>
</li>
</ul>
<h4 id="Validating-the-Clusters"><a href="#Validating-the-Clusters" class="headerlink" title="Validating the Clusters"></a>Validating the Clusters</h4><p>Need to validate such that our clustering is not a clustering of the noise.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Ziqi Yang</p>
              <p class="site-description motion-element" itemprop="description">Welcome to my hub</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">12</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ziqi Yang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
